<%- include('../partials/head'); %>

  <%- include('../partials/navbar'); %>

  <% category.products.forEach(product => { %>
    <% if(id == product._id){ %>
      <div class="container bg-success bg-opacity-25 d-flex flex-column align-items-center bg-success text-start p-3 my-5 rounded-5 shadow">

        <div id="info_product" class="flex-column align-items-center w-100">
          <h5 class="display-3 border-bottom border-dark border-2 pb-3 ps-3 mb-3 w-75"><%= product.productName %></h5>

          <img 
            src="/<%= product.image %>" 
            class="img-fluid rounded-3 shadow-sm w-75 my-2"
          >

          <p class="shadow-sm bg-success bg-gradient bg-opacity-50 w-75 p-3 rounded-4 my-2">Brand: <%= product.brand %></p>
          <p class="shadow-sm bg-success bg-gradient bg-opacity-50 w-75 p-3 rounded-4 my-2">Categorie: <%= product.productCategory %></p>
          <p class="shadow-sm bg-success bg-gradient bg-opacity-50 w-75 p-3 rounded-4 my-2">Pret: <%= product.price %> RON / KG</p>
          <p class="shadow-sm bg-success bg-gradient bg-opacity-50 w-75 p-3 rounded-4 my-2">Contact: <%= product.contact %></p>
          <p class="shadow-sm bg-success bg-gradient bg-opacity-50 w-75 p-3 rounded-4 my-2">Descriere: <%= product.description %></p>
        </div>

        <form 
          action="/update_product/<%= category.products[0]._id %>" 
          method="post" 
          enctype="multipart/form-data"
          id="form_edit_product"
          class="flex-column flex-nowrap justify-content-between align-items-center"
        >

          <% if(typeof(error.nameProduct) != 'undefined' && error.nameProduct != null && valueName === ''){ %>
            <p id="error_product" class="mb-1 mt-2 text-danger fw-bold fs-6"><%= error.nameProduct; %></p>
          <% } %>
          <input 
            type="text" 
            id="nameProduct"
            class="p-3 my-2 rounded-4 border-0 shadow-sm" 
            name="nameProduct"
            placeholder="Adauga numele produsului"
            <% if(error.nameProduct){ %>
              value="<%= valueName; %>"
            <% } else { %>
              value="<%= category.products[0].productName; %>"
            <% } %>
          >

          <div class="element d-flex flex-row justify-content-center shadow-sm rounded-4 my-2">
            <input 
              type="file"
              name="imageProduct" 
              id="imageProduct"
              accept="image/*"
              class="d-none"
              value="/<%= category.products[0].image %>"
            >
            <label 
              for="imageProduct" 
              id="imageProduct-preview" 
              class="rounded-4"
            >
            <img 
              src="/images/post_model.jpg" 
              class="rounded-4"
            >
            <div class="add rounded">
              <div class="rotate">
                  <div class="line1"></div>
                  <div class="line2"></div>
              </div>
            </div>
            </label>
          </div>

          <% if(typeof(error.brandProduct) != 'undefined' && error.brandProduct != null && valueBrand === ''){ %>
            <p id="error_product" class="mb-1 mt-2 text-danger fw-bold fs-6"><%= error.brandProduct; %></p>
          <% } %>
          <input 
            type="text" 
            id="brandProduct" 
            class="p-3 my-2 rounded-4 border-0 shadow-sm"
            name="brandProduct" 
            placeholder="Care este brand-ul tau?"
            <% if(error.brandProduct){ %>
              value="<%= valueBrand; %>"
            <% } else { %>
              value="<%= category.products[0].brand; %>"
            <% } %>
          >

          <% if(typeof(error.priceProduct) != 'undefined' && error.priceProduct != null && valuePrice === ''){ %>
            <p id="error_product" class="mb-1 mt-2 text-danger fw-bold fs-6"><%= error.priceProduct; %></p>
          <% } %>
          <input 
            type="text" 
            id="priceProduct" 
            class="p-3 my-2 rounded-4 border-0 shadow-sm"
            name="priceProduct" 
            placeholder="Adauga pretul produsului"
            <% if(error.priceProduct){ %>
              value="<%= valuePrice; %>"
            <% } else { %>
              value="<%= category.products[0].price; %>"
            <% } %>
          >

          <% if(typeof(error.contactProduct) != 'undefined' && error.contactProduct != null && valueContact === ''){ %>
            <p id="error_product" class="mb-1 mt-2 text-danger fw-bold fs-6"><%= error.contactProduct; %></p>
          <% } %>
          <input 
            type="tel" 
            id="contactProduct" 
            class="p-3 my-2 rounded-4 border-0 shadow-sm"
            name="contactProduct" 
            placeholder="Adauga un numar de contact"
            <% if(error.contactProduct){ %>
              value="<%= valueContact; %>"
            <% } else { %>
              value="<%= category.products[0].contact; %>"
            <% } %>
          >

          <% if(typeof(error.infoProduct) != 'undefined' && error.infoProduct != null && valueDescription === ''){ %>
            <p id="error_product" class="mb-1 mt-2 text-danger fw-bold fs-6"><%= error.infoProduct; %></p>
          <% } %>
          <textarea 
            id="infoProduct" 
            class="p-3 my-2 rounded-4 border-0 shadow-sm"
            name="infoProduct" 
            placeholder="Descrieti produsul"
          ><% if(error.infoProduct){ %><%= valueDescription; %><% } else { %><%= category.products[0].description; %><% } %></textarea>

          <button 
            class="rounded-4 p-3 m-2 bg-white shadow-sm border-0"
          >
            Adauga produsul
          </button>
        </form>
        
        <div class="d-flex flex-row flex-nowrap justify-content-between align-items-center w-50">
          <button 
            id="edit_product" 
            class="rounded-4 p-3 m-2 bg-white shadow-sm border-0"
          >
            Editeaza
          </button>

          <form 
            action="/delete_product/<%= category.products[0]._id %>" 
            method="post" 
            id="delete_product"
          >
            <button 
              class="rounded-4 p-3 m-2 bg-white shadow-sm border-0"
            >
              Sterge
            </button>
          </form>
        </div>
      </div>
    <% } %>
  <% }); %>

<%- include('../partials/footer'); %>